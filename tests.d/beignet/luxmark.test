xdpyinfo >/dev/null 2>&1 || return 1 # LuxMark expects an X connection

__luxmark__() {
    cd $LUXMARK_FOLDER # set me in test_options.sh!
    for (( c=0; c<$1; c++ )); do
        LD_LIBRARY_PATH=./lib:$LD_LIBRARY_PATH \
        run_bench 0 ./luxmark.bin --single-run --mode=BENCHMARK_OCL_GPU --scene=$2 \
        | awk '{print $2 }' || return 1
    done
}

while read name scene; do
   test_name="$test_name luxmark:$name"
   eval "luxmark:${name}_run() { __luxmark__ \$1 $scene; }"
done<<EOF
	LuxBall LUXBALL_HDR
	Microphone MICROPHONE
	Hotel HOTEL
EOF

test_exec_time=121
