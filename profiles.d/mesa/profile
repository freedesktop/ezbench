source "$ezBenchDir/profiles.d/utils/common.sh"

# Accessible variables
# $ezBenchDir            [RO]: Directory of the ezbench
# ------------------
# $rounds                [WO]: Default number of rounds
# $makeAndDeployCmd      [WO]: Command to compile and deploy the current git HEAD
# $gitVersionDeployedCmd [WO]: Command to print out the sha1 of the version currently deployed
# $repoDir               [WO]: Path to the git repo to use for this profile
# $reportName            [WO]: Name to give to your report
# $testsDir              [WO]: List of pathes to the directories containing the tests for this profile
# $testsList             [WO]: List of tests that should be ran in this profile
# $testExcludeList       [WO]: List of tests that should be excluded in this profile

function __compile__() {
    make -j8 || return 71
    make_install_sha1_dump || return 72
    return 0
}

function __default_make_and_deploy__() {
    # Return error codes:
    # 71: Compilation error
    # 72: Deployment error

    x_show_debug_info_start

    __compile__
    compile_error=$?

    x_show_debug_info_stop

    return $compile_error
}

function __git_version_deployed__() {
    glxinfo 2> /dev/null | sed -n 's/.*(git-\(.*\)).*/\1/p' | head -1
}

rounds=3
makeAndDeployCmd="__default_make_and_deploy__"
repoDir="$REPO_MESA"
gitVersionDeployedCmd="__git_version_deployed__"
